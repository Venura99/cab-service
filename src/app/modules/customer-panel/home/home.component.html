<!-- home.component.html -->

<!-- HERO SECTION -->
<section class="hero-section">
  <div class="hero-container">
    <div class="hero-content">
      <h1 class="hero-title">
        Find Your Perfect <span class="text-gradient">Vehicle</span>
      </h1>
      <p class="hero-subtitle">
        Buy, Sell & Discover Cars, Bikes & Vans across Sri Lanka
      </p>

      <!-- Search Box -->
      <div class="hero-search">
        <div class="search-box-wrapper">
          <i class="pi pi-search search-icon"></i>
          <p-autoComplete
            [(ngModel)]="searchQuery"
            [suggestions]="searchSuggestions"
            (completeMethod)="searchVehicles($event)"
            placeholder="Search by brand, model, or keyword..."
            field="name"
            appendTo="body"
            (onSelect)="onSearchSelect($event)"
            styleClass="search-autocomplete"
          >
            <ng-template let-item pTemplate="item">
              <div class="suggestion-item">
                <i [class]="item.icon || 'pi pi-car'"></i>
                <span>{{ item.name }}</span>
              </div>
            </ng-template>
          </p-autoComplete>
          <button pButton label="Search" class="search-submit-btn"></button>
        </div>
      </div>

      <!-- Quick Stats -->
      <div class="hero-stats">
        <div class="stat-item">
          <i class="pi pi-car"></i>
          <div>
            <strong>50,000+</strong>
            <span>Vehicles</span>
          </div>
        </div>
        <div class="stat-item">
          <i class="pi pi-users"></i>
          <div>
            <strong>100K+</strong>
            <span>Users</span>
          </div>
        </div>
        <div class="stat-item">
          <i class="pi pi-check-circle"></i>
          <div>
            <strong>Verified</strong>
            <span>Sellers</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- CATEGORIES SECTION -->
<section class="categories-section">
  <div class="container">
    <div class="section-header">
      <h2 class="section-title">Browse by Category</h2>
      <p class="section-subtitle">Find what you're looking for</p>
    </div>

    <div class="categories-grid">
      <div
        *ngFor="let cat of categories"
        class="category-card"
        (click)="filterByCategory(cat.type)"
      >
        <div class="category-icon" [style.background]="cat.gradient">
          <i [class]="cat.icon"></i>
        </div>
        <h3 class="category-name">{{ cat.name }}</h3>
        <p class="category-count">{{ cat.count | number }} ads</p>
      </div>
    </div>
  </div>
</section>

<!-- FEATURED VEHICLES -->
<section class="featured-section">
  <div class="container">
    <div class="section-header-inline">
      <div>
        <h2 class="section-title">Featured Vehicles</h2>
        <p class="section-subtitle">Hand-picked premium listings</p>
      </div>
      <button 
        pButton 
        label="View All" 
        icon="pi pi-arrow-right" 
        iconPos="right"
        class="p-button-text view-all-btn"
        routerLink="/vehicles">
      </button>
    </div>

    <p-carousel
      [value]="specials"
      [numVisible]="4"
      [numScroll]="1"
      [circular]="true"
      [autoplayInterval]="5000"
      [responsiveOptions]="carouselResponsiveOptions"
    >
      <ng-template let-vehicle pTemplate="item">
        <div class="carousel-item-wrapper">
          <app-vehicle-card [vehicle]="vehicle" [isSpecial]="true"></app-vehicle-card>
        </div>
      </ng-template>
    </p-carousel>
  </div>
</section>

<!-- LATEST VEHICLES -->
<section class="vehicles-section">
  <div class="container">
    <div class="section-header-inline">
      <div>
        <h2 class="section-title">Latest Vehicles</h2>
        <p class="section-subtitle">Recently posted ads</p>
      </div>
      <button 
        pButton 
        label="Post Your Ad" 
        icon="pi pi-plus-circle" 
        class="p-button-success post-btn"
        (click)="postVehicle()">
      </button>
    </div>

    <!-- Filters Bar -->
    <div class="filters-wrapper">
      <div class="filters-bar">
        <!-- Active Filters -->
        <div class="active-filters" *ngIf="activeFilters.length > 0">
          <p-chip
            *ngFor="let f of activeFilters"
            [label]="f.name"
            [removable]="true"
            (onRemove)="removeFilter(f)"
            styleClass="filter-chip"
          ></p-chip>
        </div>

        <!-- Filter Dropdowns -->
        <div class="filter-controls">
          <p-dropdown
            [options]="vehicleTypes"
            [(ngModel)]="selectedType"
            placeholder="All Types"
            (onChange)="applyFilter()"
            styleClass="filter-dropdown"
          ></p-dropdown>

          <p-dropdown
            [options]="priceRanges"
            [(ngModel)]="selectedPrice"
            placeholder="Price Range"
            (onChange)="applyFilter()"
            styleClass="filter-dropdown"
          ></p-dropdown>

          <p-dropdown
            [options]="locations"
            [(ngModel)]="selectedLocation"
            placeholder="All Locations"
            (onChange)="applyFilter()"
            styleClass="filter-dropdown"
          ></p-dropdown>

          <p-dropdown
            [options]="sortOptions"
            [(ngModel)]="selectedSort"
            placeholder="Sort By"
            (onChange)="applySort()"
            styleClass="filter-dropdown"
          ></p-dropdown>

          <button 
            pButton 
            label="Clear All" 
            icon="pi pi-times" 
            class="p-button-outlined p-button-secondary clear-btn"
            (click)="clearFilters()"
            *ngIf="activeFilters.length > 0">
          </button>
        </div>
      </div>
    </div>

    <!-- Vehicles Grid -->
    <div class="vehicles-grid" *ngIf="!loading">
      <app-vehicle-card
        *ngFor="let vehicle of filteredVehicles; trackBy: trackById"
        [vehicle]="vehicle">
      </app-vehicle-card>
    </div>

    <!-- Loading State -->
    <div class="vehicles-grid" *ngIf="loading">
      <p-skeleton 
        *ngFor="let i of [1,2,3,4,5,6,7,8]"
        height="420px" 
        borderRadius="16px">
      </p-skeleton>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="!loading && filteredVehicles.length === 0">
      <i class="pi pi-search"></i>
      <h3>No vehicles found</h3>
      <p>Try adjusting your filters or search criteria</p>
      <button pButton label="Clear Filters" (click)="clearFilters()"></button>
    </div>

    <!-- Pagination -->
    <p-paginator
      *ngIf="totalRecords > pageSize"
      [rows]="pageSize"
      [totalRecords]="totalRecords"
      [rowsPerPageOptions]="[12, 24, 48]"
      (onPageChange)="loadPage($event)"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} vehicles"
    ></p-paginator>
  </div>
</section>

<!-- CTA BANNER -->
<section class="cta-banner">
  <div class="container">
    <div class="cta-content">
      <div class="cta-text">
        <h2>Ready to Sell Your Vehicle?</h2>
        <p>Post your ad for FREE and reach thousands of buyers</p>
      </div>
      <button 
        pButton 
        label="POST AD NOW" 
        icon="pi pi-plus-circle" 
        class="p-button-lg cta-button"
        (click)="postVehicle()">
      </button>
    </div>
  </div>
</section>

<!-- SPARE PARTS PROMO -->
<section class="spare-parts-section">
  <div class="container">
    <div class="spare-parts-card">
      <div class="spare-parts-content">
        <i class="pi pi-wrench"></i>
        <div>
          <h3>Spare Parts Store</h3>
          <p>Genuine parts with island-wide delivery</p>
        </div>
      </div>
      <button 
        pButton 
        label="Shop Now" 
        icon="pi pi-shopping-cart" 
        class="p-button-outlined shop-btn"
        routerLink="/spare-parts">
      </button>
    </div>
  </div>
</section>